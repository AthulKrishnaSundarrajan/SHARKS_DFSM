function [Y,Xf,Af] = mynet(X,~,~)
%MYNET neural network simulation function.
%
% Auto-generated by MATLAB, 25-Mar-2022 12:57:02.
% 
% [Y] = mynet(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.275598565912053;-0.953264998445329;0.673402614475962;-1;-0.901798049526029;0.546373245859257;0.427369163764481;0];
x1_step1.gain = [2.76090011130098;1.02392660575594;6.12374773542943;1.02006502176007;1.051636371432;4.40891103036545;3.49265158884565;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.1689003959239085972;1.0210717009323766469;-1.6826813390041890361;0.62684805064232074212;0.75274001776362420291;0.17925850947539942459;1.0424855621651927251;-4.261251040037469906;1.2334425886250126592;-1.1710818141898744482];
IW1_1 = [1.4274598219574206048 0.091069522292661977958 0.73842312902536388908 -0.35203560691534013793 -0.24800049216356501169 0.20843207044217113011 -2.7912054064104849793 -0.56157653934491624792;0.93408338838693327766 0.019404815945883481521 -5.168942192203036079 1.1915189397332335286 -0.94919513302152347389 2.3480817982891633022 1.4508671387159643995 2.2269695203180885912;-0.52793361924375459271 -0.04028946147505366171 -0.39131816743792141589 -0.26680611113533120315 -1.0547991450141127601 2.8871148143929290519 2.3508398934715555306 0.2367321699508448396;0.39941629986004267838 0.0034211806884207858828 -2.9456286175884538459 0.024410206016156500014 0.045228646458096426197 -0.47602421281836010403 1.7105278531439689349 0.80036018337714109894;-0.21394915944402959074 0.00024182483258099226188 -1.5023754759597349739 -0.013955921343030402298 -0.24090644056755702862 0.47061679823117952282 0.65182737495068054923 0.87471818924700506237;-1.1326746393665336754 -0.0088919075946739187244 1.1551984455396406837 -0.015531059708900651559 -0.30032457535476725363 0.46713487471417014518 -0.4736989599519677574 1.0557721700552407107;-0.45988079070787307723 0.062254170489287857793 -4.5636381317869796348 1.4044319099262705386 -0.16274140507097509256 -3.2605882079401489193 4.2252542753882353921 1.3373565149004389419;-1.1581599373469770864 -0.012436823372338152993 10.517727065616233162 -2.4291874210958335212 0.12605657489703644969 -3.1723479421003091261 -1.0332220819592603522 -2.7772925328162068048;3.1646136242604936406 -0.017730314502754383754 -2.5494895539245439053 1.0975837350370993839 0.00027564344029250916097 -2.1097030342383518153 1.6874663856107152693 1.3097473139430229061;-0.8594177657938379955 -0.028687142344036065805 0.73418386398183987929 -0.24181286587274269939 0.8922308952079585076 -0.31808778153893935148 1.2807108387974461827 -1.1669614205419522879];

% Layer 2
b2 = [-0.10345544921791710591;-1.0546469233020516754;5.3054466171123726426;0.29210368909076417365;1.7041545690570218952;-1.4145998204897507478;0.12568167425761661571;0.44488475265248816903;-1.0781421789531737687;0.54370681015883681741];
LW2_1 = [-0.45392140835353567141 -0.75394508821149874844 -4.6611673167079885616 4.8816667244548170856 -5.8689424297025789556 9.0217520785179381448 0.1110357809760656872 0.39583272712433081875 -1.5380025840273507942 -0.70411723438294215871;-0.015953235405034807415 -1.9702344806202587435 -1.7000251678980864423 -3.395391291555505564 6.1941850357382381986 1.3566327573066900847 0.035678211456810299262 -0.77196018945842781456 0.93809071744117022984 0.98714593293848706956;6.9043857505727830315 -1.9276689495261221108 -1.6279566746805667066 0.73022048371571379732 0.88438318594779274928 1.5257851239528785747 -0.42500946592818095171 -1.5178631327129714634 1.7348524064670143296 1.600562163852805142;1.9380787743482714713 0.38385190764546484044 -1.1747838217261921123 -5.5948137599498526384 7.8887932742241506645 -2.4150472009945742613 0.87821307541550219788 0.79955446800192364609 1.2991749975690740637 2.6891815709709225857;1.8457749531469560544 0.29933584158775222717 1.4233426695062103562 0.12552399687390428107 -2.7943328859858804769 1.9857680764910337068 -0.01154262619664452906 1.0921726530711322045 0.5290177278288797913 1.0306545201585339822;-1.2158834816745289764 -2.9298151582664329062 -0.42587329884186164719 -3.8918383394961892918 9.6668725529655734618 -3.1874421499904039834 0.39356427079793582235 0.24543802371220371783 0.63188887384527425706 0.086900514582234925087;-2.6159700781171095763 -0.23762844591340098743 1.6802570892105863631 7.6819190025677812628 -11.305836659568960556 3.2102722963053134109 -1.1115341730883303573 -0.91444324725771575224 -1.8589353461986335425 -3.5208935973432584632;-1.3363786290426633574 -1.0734391076485596539 -0.24341061442795119962 2.3671916488716737703 -1.3172747746376873845 1.3172209711296012369 -0.19498494548863612441 -0.85625092883998410453 -0.46982728806858276016 -0.61401672546018659649;-4.8689364785590916185 -7.4447832904557360578 4.6928557184563564064 -3.7274821107914410945 -1.9405262267291549794 -1.0113548498812958698 4.1447810853269375642 -3.3228743567763907585 -6.9274302834012280172 -7.0558833743735789312;0.12479383046956415981 0.34531778328677903422 1.3700584555821073707 0.66338885705633587886 -1.0676304222325312399 -0.59618770821373578972 0.21333016251623335147 0.12506752717986283074 -0.86790791669826583554 -0.62091431521279139005];

% Layer 3
b3 = [0.017022417363236511806;-0.14577485586629526648;-1.0345061188251012396];
LW3_2 = [0.0015282484380090312348 -0.0011651078232742405252 0.0023849858382488518978 0.012842463484115964473 0.0035413522304435420679 -0.0043178788404019900066 0.011373198018947450541 0.0057910263113040687938 -0.00066395561181375919568 -0.0037527781229734860115;-0.22698854109111687993 0.5201157106452761747 0.89959577762792608535 3.7042775601937649732 0.55622114159895574836 -1.2010057752107328177 3.1089921431523950268 0.70589662964474220175 -0.055790175531043866008 0.58725738081791067913;-0.68609676355919213542 0.49133097196345981716 0.009240361833029104785 -0.9494841535499651819 -0.73851605084619198482 1.0273634105000566397 -0.78504872549953519378 -0.84899734300952167665 -0.15916065281923230668 1.2430165561967969623];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1.01644036952029;1.04949463842623;1.01855959776328];
y1_step1.xoffset = [-1;-1;-1];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
