function [Y,Xf,Af] = mynet(X,~,~)
%MYNET neural network simulation function.
%
% Auto-generated by MATLAB, 15-Mar-2022 17:39:39.
% 
% [Y] = mynet(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.609185224449949;-0.100085613213422;-0.35283425008082;-0.354415080909122;-0.804560193746746;0.0617420712346222;0.558572192207761;0.385274067217035];
x1_step1.gain = [5.11751378177836;1.81804289409575;1.47837770952393;1.47665219340111;1.10834554103267;2.13161001754787;4.53075217441062;3.25348239490349];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.12599319757231236538;0.034324542495408262577;-0.4002100966497186274;1.3141396767040769422;1.9130506439399257435;0.31971230301947944907;0.49267001356192258177;-2.2480027996312355043;0.58504128401281252359;-1.3170290343752548701];
IW1_1 = [0.92038051491070682619 0.69794936338670143794 -0.109159275660398708 0.06538484122440259283 -0.021380115853710451174 2.405574298746138151 0.22812376604410583569 -1.495399228870519126;-0.21291670703194051639 1.3226612561191328776 -1.5291676701049907727 0.28141755757923631043 -0.090463552767856683645 0.062497269137063694855 0.44463396253798692648 -0.1972298437519831027;0.27513339436182093767 0.61594263744585187048 0.14037582787060323697 0.094709014645632111362 -0.016723907043271941247 0.87433487203639026486 0.13127897493298096299 -0.17499003167617371846;0.80567221277732403717 1.0111706261114401517 -0.81629373085908263352 1.0669200883294218674 -1.0106471928233882185 2.0857200771307349285 -0.77369180392020064918 -2.1804186145604327329;6.0476325171731577512 -0.30257935838578775556 -0.3959131045171924157 -1.3693858313661382287 0.18020498368218715313 -3.3288889267234393898 0.65248402885958112218 -0.65559860093768140832;-1.3005630930277485291 -0.79117036941726104349 0.11724884292866534496 0.11647754534225251977 -0.026967821158925851105 0.35332250428612660409 -0.10301110995142517823 0.0095933709585001355341;0.023178219204893334843 0.059439082308805464561 -0.83513951630826599448 0.20171735026384546297 0.19401637461020709852 -0.74218652453988431805 -0.2394227916921176369 0.064210817727706065439;-0.23698125497095801073 -1.7668556659171004153 -0.1478686253636921355 3.0557385795239078163 0.38758650682024398115 0.12031051029423543708 -3.1242124095918217819 2.9563248098978638367;-0.47627623100445365401 -0.45216106192011451537 -0.077786757946857854051 -0.29888608000136818177 -1.118310473433135277 -1.2941425813761981978 0.14052818238697903364 -0.05578371704511604634;-3.4407219461026645746 2.6521195390598699682 0.16094253229342520006 1.0975918010503742384 0.035892096443179047349 1.5155562691732038516 -0.49492912626501622819 -0.64768725481155153822];

% Layer 2
b2 = [-1.7702450938904144007;0.34671060673273040864;-3.183852761056818359;-2.3325218182132414491;0.27689658106204345644;-0.61442882427170730786;1.1943675824333976898;0.71196293557412659858;0.49455877081591431699;-0.02446806746166544505];
LW2_1 = [-1.1867444833714901886 -1.9769724748129846592 11.421600114505237045 -0.18359987314985115603 0.83091680337065243478 2.85466195343553375 6.0876450374757427042 -0.38058845021708370693 1.190914882629046545 -0.25709651829876245532;0.26208808836625424599 0.12992676762930496781 1.0064114987417107638 -0.4045491430359814955 0.0039071029438238393666 0.013628490348502719787 0.18811710145454968446 -0.32841351914137623114 0.44660666208238053443 -0.04115148883853805839;7.0592969820129054526 -11.10825440266181019 39.12921277829328659 -5.5172993933594556282 6.3215435545325657785 7.5574652068730614474 34.082034563252271653 -2.7662676715053025056 9.3067445241371711262 2.9019734109871979655;7.0463663342636326803 2.723360545409455824 -34.30454179968870676 0.20024932386021390696 -3.8472229170839500334 -9.6334208360279536265 -11.508157797538164147 0.59379115618892031048 -2.2629765339113281364 1.8660219200297594178;0.090499138582201682501 0.041530146632840297949 0.36631866774045590551 -0.19305294011937076948 -2.3822568144877667636e-05 0.010829561664053020606 0.02406518377689549279 -0.17824805620298295183 0.18872455041918953511 -0.016211555310899180421;-0.0026927432335611322864 -0.24708321260491214466 -0.15117166971245671325 0.075019551648683333034 0.0063065308525298664419 0.03372285404154502092 -0.18502330571588443409 0.038645661624211624652 -0.10154729157687569785 0.030303558107110079023;-2.684076437682001437 -0.82739963513595504718 11.550681616705986698 0.3890377957330821701 0.75075238084924589277 2.8523577878367696314 3.3720981860463785651 -0.37235693623118637507 0.19587449663576306236 -0.61518649963494109745;-0.24956105185640353739 -2.9542282974734264123 10.910756975673459479 -0.84054475709769005398 -1.6083955208720268626 -0.32889323710898371589 8.3068525193651332472 -0.74348197617440736629 2.0790659657335228694 -0.25714142444866511239;-0.10854703258085511564 -0.34185618104111542559 1.8520680959415498634 -0.083751324371096808052 -0.273070465341639812 0.49099260908750214094 1.0515040077368478233 -0.03150692169253926922 0.26787752795994779209 0.011600572869004776091;0.21126818373877104262 -0.60173690444627236928 3.432432444578218611 -0.4573887393834584203 -0.56654333064703021883 1.3852458208550866292 2.0141295824506060264 0.028681165399816591077 0.788555980619036756 0.19477426766936553615];

% Layer 3
b3 = [-24.286640264101592379;-11.397453360250333176;-0.056485210642059774377];
LW3_2 = [-5.3500407940103258397 -2.0592939040524043115 -0.41162606577654664575 -1.4019117997641565854 6.7788113422793756513 -0.26290046372378095274 -3.1677471678407647104 -2.2047789423567540901 48.462440016759138928 -17.799937318906177808;-0.23046764530436508744 -20.683431187105028926 -0.011091199421202100478 0.024469653826715835609 43.953088223519685585 -9.6922375962842153285 0.086702631482011793818 0.010545516723881544555 -0.53523657818134007247 -0.15227483293512236728;0.26023264815499985714 2.2375085825818703533 0.0099424829417348835336 0.045183160561003167521 -5.3089651761560689991 -3.3649088257492056897 0.11331136855996873369 0.059430670533007753931 -2.3179899751492851756 0.85886635897933671924];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1.11957508301753;1.55628389110962;1.14345745668368];
y1_step1.xoffset = [-1;-1;-0.74908125204807];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
